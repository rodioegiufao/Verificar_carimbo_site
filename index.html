<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analisador de Carimbos PDF</title>
    <link rel="stylesheet" href="styles/main.css">
    <!-- Usar vers√£o compat√≠vel do PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>üìÑ Analisador de Carimbos em PDFs</h1>
                <p>Esta ferramenta verifica a presen√ßa de palavras-chave em arquivos PDF e gera um relat√≥rio.</p>
            </div>
        </header>

        <div class="main-layout">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="sidebar-section">
                    <h3>Configura√ß√µes</h3>
                    
                    <!-- Upload de PDFs -->
                    <div class="form-group">
                        <label>Selecione os arquivos PDF</label>
                        <div class="file-upload-area" id="fileUploadArea">
                            <div class="upload-icon">üìé</div>
                            <p>Arraste e solte arquivos aqui</p>
                            <p class="upload-subtext">Limite: 200MB por arquivo ‚Ä¢ PDF</p>
                            <button type="button" class="browse-button" onclick="document.getElementById('pdfUpload').click()">
                                Procurar arquivos
                            </button>
                            <input type="file" id="pdfUpload" accept=".pdf" multiple class="hidden">
                        </div>
                        <div id="fileList" class="file-list"></div>
                    </div>

                    <!-- Palavras-chave -->
                    <div class="form-group">
                        <h4>Palavras-chave</h4>
                        
                        <div class="info-box">
                            <div class="info-header">
                                <span class="info-icon">üîç</span>
                                <strong>Engenheiros e CREAs ser√£o SEMPRE pesquisados:</strong>
                            </div>
                            <div class="expand-section">
                                <button type="button" class="expand-btn" onclick="toggleExpand('engenheiros')">
                                    Ver engenheiros e CREAs fixos
                                </button>
                                <div id="engenheiros" class="expand-content">
                                    <!-- Preenchido via JavaScript -->
                                </div>
                            </div>
                        </div>

                        <div class="info-box">
                            <div class="info-header">
                                <span class="info-icon">üóÇÔ∏è</span>
                                <strong>Mapeamento de c√≥digos de projeto:</strong>
                            </div>
                            <div class="expand-section">
                                <button type="button" class="expand-btn" onclick="toggleExpand('projetos')">
                                    Ver mapeamento de projetos
                                </button>
                                <div id="projetos" class="expand-content">
                                    <!-- Preenchido via JavaScript -->
                                </div>
                            </div>
                        </div>

                        <label>Palavras-chave adicionais do projeto (uma por linha)</label>
                        <textarea id="keywordsInput" rows="6" class="text-area" placeholder="Insira uma palavra-chave por linha..."></textarea>
                    </div>

                    <!-- Op√ß√µes -->
                    <div class="form-group">
                        <h4>Op√ß√µes</h4>
                        <div class="options-list">
                            <label class="option-item">
                                <input type="checkbox" id="checkFilename" checked>
                                <span class="checkmark"></span>
                                Verificar nome do arquivo no conte√∫do
                            </label>
                            <label class="option-item">
                                <input type="checkbox" id="checkSheetNumber" checked>
                                <span class="checkmark"></span>
                                Verificar n√∫mero da prancha no conte√∫do
                            </label>
                            <label class="option-item">
                                <input type="checkbox" id="checkProjeto" checked>
                                <span class="checkmark"></span>
                                Verificar descri√ß√£o do projeto no conte√∫do
                            </label>
                        </div>
                    </div>

                    <!-- Bot√£o de an√°lise -->
                    <button type="button" id="analyzeButton" class="analyze-button" onclick="iniciarAnalise()">
                        Iniciar An√°lise
                    </button>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="content">
                <!-- Tabs -->
                <div class="tabs">
                    <button type="button" class="tab-btn active" data-tab="analisador">Analisador de PDF</button>
                    <button type="button" class="tab-btn" data-tab="tutorial">Tutorial em V√≠deo</button>
                </div>

                <!-- Conte√∫do das Tabs -->
                <!-- Conte√∫do das Tabs -->
                <div class="tab-content">
                    <!-- Tab Analisador -->
                    <div id="analisador" class="tab-pane active" style="display: block; opacity: 1;">
                        <div class="welcome-card">
                            <div class="welcome-icon">üëà</div>
                            <div class="welcome-content">
                                <h3>Use a barra lateral para configurar e iniciar a an√°lise.</h3>
                                
                                <div class="instructions">
                                    <h4>Como usar:</h4>
                                    <ol>
                                        <li>Selecione os arquivos PDF que deseja analisar</li>
                                        <li>Insira palavras-chave adicionais do projeto (opcional)</li>
                                        <li>Ajuste as op√ß√µes conforme necess√°rio</li>
                                        <li>Clique em "Iniciar An√°lise"</li>
                                    </ol>
                                </div>

                                <div class="important-info">
                                    <h4>‚ö†Ô∏è Importante:</h4>
                                    <ul>
                                        <li><strong>Engenheiros e CREAs ser√£o SEMPRE pesquisados</strong> automaticamente</li>
                                        <li>As palavras-chave adicionais s√£o para complementar a busca</li>
                                        <li>Os engenheiros pr√©-configurados n√£o podem ser desativados</li>
                                        <li>A verifica√ß√£o de assinatura √© feita pelo nome do arquivo (presen√ßa de "assinado")</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- √Årea de Resultados (inicialmente oculta) -->
                        <div id="resultsArea" class="hidden">
                            <!-- Resultados da An√°lise -->
                            <div class="results-card">
                                <h3>Resultados da An√°lise</h3>
                                <div class="table-container">
                                    <table id="resultsTable" class="results-table">
                                        <thead>
                                            <tr>
                                                <th>Prancha</th>
                                                <th>C√≥digo Projeto</th>
                                                <th>Descri√ß√£o Projeto</th>
                                                <th>Palavras-chave</th>
                                                <th>Nome</th>
                                                <th>Prancha</th>
                                                <th>Assinado</th>
                                                <th>Projeto</th>
                                            </tr>
                                        </thead>
                                        <tbody id="resultsBody">
                                            <!-- Preenchido via JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Estat√≠sticas -->
                            <div class="stats-card">
                                <h3>Estat√≠sticas</h3>
                                <div class="stats-grid">
                                    <div class="stat-item">
                                        <div class="stat-value" id="totalFiles">0</div>
                                        <div class="stat-label">Total de Arquivos</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value" id="filesWithName">0</div>
                                        <div class="stat-label">Nome Encontrado</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value" id="filesWithSheet">0</div>
                                        <div class="stat-label">Prancha Encontrada</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value" id="filesSigned">0</div>
                                        <div class="stat-label">Arquivos Assinados</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value" id="projectsFound">0</div>
                                        <div class="stat-label">Projetos Encontrados</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Engenheiros Encontrados -->
                            <div class="results-card">
                                <h3>Engenheiros Encontrados</h3>
                                <div id="engineersFound" class="found-items">
                                    <!-- Preenchido via JavaScript -->
                                </div>
                            </div>

                            <!-- Detalhamento dos Projetos -->
                            <div class="results-card">
                                <h3>Detalhamento dos Projetos</h3>
                                <div id="projectsDetails" class="found-items">
                                    <!-- Preenchido via JavaScript -->
                                </div>
                            </div>

                            <!-- Bot√£o Download -->
                            <div class="download-section">
                                <button type="button" id="downloadButton" class="download-btn" onclick="baixarExcel()">
                                    üì• Baixar Resultados em Excel
                                </button>
                            </div>
                        </div>

                        <!-- Progress Bar -->
                        <div id="progressArea" class="hidden">
                            <div class="progress-card">
                                <h3>Processando PDFs...</h3>
                                <div class="progress-container">
                                    <div class="progress-bar">
                                        <div id="progressFill" class="progress-fill"></div>
                                    </div>
                                    <div id="progressText" class="progress-text">0%</div>
                                </div>
                                <div id="fileProgress" class="file-progress">Processando: -</div>
                            </div>
                        </div>
                    </div>

                    <!-- Tab Tutorial -->
                    <div id="tutorial" class="tab-pane" style="display: none; opacity: 0;">
                        <div class="tutorial-card">
                            <h3>üìπ Tutorial em V√≠deo</h3>
                            <p>Assista ao v√≠deo abaixo para aprender como usar o analisador de PDF:</p>
                            
                            <div class="video-container">
                                <iframe width="100%" height="400" src="https://www.youtube.com/embed/GB6hvQPODCw" 
                                        frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                        allowfullscreen></iframe>
                            </div>

                            <div class="tutorial-content">
                                <h4>Pontos abordados no tutorial:</h4>
                                <ul>
                                    <li>Como preparar seus arquivos PDF para an√°lise</li>
                                    <li>Como usar palavras-chave adicionais do projeto</li>
                                    <li>Interpreta√ß√£o dos resultados</li>
                                    <li>Como usar o relat√≥rio em Excel gerado</li>
                                    <li>Entendendo a busca autom√°tica por engenheiros e CREAs</li>
                                    <li>Entendendo o mapeamento autom√°tico de c√≥digos de projeto</li>
                                </ul>

                                <h4>Engenheiros e CREAs configurados (busca autom√°tica):</h4>
                                <div class="table-container">
                                    <table class="info-table">
                                        <thead>
                                            <tr>
                                                <th>Engenheiro</th>
                                                <th>CREA(s)</th>
                                            </tr>
                                        </thead>
                                        <tbody id="engineersTable">
                                            <!-- Preenchido via JavaScript -->
                                        </tbody>
                                    </table>
                                </div>

                                <h4>Mapeamento de c√≥digos de projeto:</h4>
                                <div class="table-container">
                                    <table class="info-table">
                                        <thead>
                                            <tr>
                                                <th>C√≥digo</th>
                                                <th>Descri√ß√£o</th>
                                            </tr>
                                        </thead>
                                        <tbody id="projectsTable">
                                            <!-- Preenchido via JavaScript -->
                                        </tbody>
                                    </table>
                                </div>

                                <div class="important-info">
                                    <h4>‚ö†Ô∏è Importante:</h4>
                                    <p>Estes engenheiros e CREAs s√£o <strong>sempre pesquisados</strong> automaticamente, 
                                    independentemente das palavras-chave adicionais inseridas.</p>
                                    
                                    <h5>Sobre a verifica√ß√£o de assinatura:</h5>
                                    <p>A verifica√ß√£o de assinatura √© feita pelo nome do arquivo. 
                                    Arquivos que cont√™m "assinado" no nome (como "PRJ-FOT-IPER-04-05_assinado.pdf") 
                                    ser√£o marcados como assinados na coluna "Arquivo assinado".</p>
                                    
                                    <h5>Sobre o mapeamento de projetos:</h5>
                                    <p>O c√≥digo do projeto √© extra√≠do automaticamente do nome do arquivo (ex: "ECX" de "PRJ-ECX-IPER-02-07")
                                    e mapeado para a descri√ß√£o correspondente. Em seguida, verifica-se se essa descri√ß√£o est√° presente no conte√∫do do PDF.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>Desenvolvido por Rodrigo Damasceno | ¬© 2025 - Todos os direitos reservados</p>
        </footer>
    </div>
    <script src="js/config.js"></script>
    <script src="js/pdf-processor.js"></script>
    <script src="js/excel-generator.js"></script>
    <script src="js/app.js"></script>
    <script src="js/main.js"></script> <!-- Novo arquivo de inicializa√ß√£o -->
</body>
</html>
